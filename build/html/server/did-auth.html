<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DID AuthN &mdash; UNiD Docs  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/twemoji.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js"></script>
        <script src="../_static/twemoji.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> UNiD Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/ubuntu-nodejs/README.html">Ubuntu (NodeJS)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">UNiD Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>DID AuthN</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/server/did-auth.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="did-authn">
<h1>DID AuthN<a class="headerlink" href="#did-authn" title="Permalink to this headline"></a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>For the web server to communicate with identity wallet on secure authenticated channel, UNiD Nodejs SDK provide methods of:</p>
<ul class="simple">
<li><p>generating DID AuthN Request</p></li>
<li><p>validating DID AuthN request from an identity wallet</p></li>
</ul>
<p>The below diagram illustrate the sign-in flow and steps taken to verify a user through their user agent from the wallet side of the webpage to the server side of a RP. If you want to see more details of DID AuthN, please head over <a class="reference external" href="../unid-platform/#unid-core">here</a>.</p>
<p><img alt="" src=".gitbook/assets/SIOP.svg" /></p>
</div>
<div class="section" id="generate-siop-request">
<h2>Generate SIOP Request<a class="headerlink" href="#generate-siop-request" title="Permalink to this headline"></a></h2>
<p>In step #1 of the diagram, the web server creates a SIOP request signed by the application’s DID. The web server can specify the credential type as the information required for authentication.</p>
<p><strong>DID.generateAuthenticationRequest()</strong></p>
<p>{% tabs %}
{% tab title=”TypeScript” %}</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="p">{</span> <span class="nx">UNiD</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/node-wallet-sdk&#39;</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DID</span><span class="p">.</span><span class="nx">generateAuthenticationRequest</span><span class="p">({</span>
            <span class="nx">requiredCredentialTypes</span><span class="o">:</span> <span class="p">[</span>
                <span class="s1">&#39;AddressCredentialV1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;NameCredentialV1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;EmailCredentialV1&#39;</span>
            <span class="p">],</span>
            <span class="nx">optionalCredentialTypes</span><span class="o">:</span> <span class="p">[</span>
                <span class="s1">&#39;GenderCredentialV1&#39;</span>
            <span class="p">]</span>
        <span class="p">})</span>
        
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Complete generating DID AuthN Request&#39;</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="nx">err</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">err</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">};</span>
<span class="p">})()</span>
</pre></div>
</div>
<p>{% endtab %}
{% endtabs %}</p>
</div>
<div class="section" id="validate-authn-response">
<h2>Validate AuthN Response<a class="headerlink" href="#validate-authn-response" title="Permalink to this headline"></a></h2>
<p>In step #6 of the diagram, the web server receives an SIOP response from the mobile wallet. The web server queries for the wallet’s DID document using DID Resolver and verifies the signature with the wallet’s public key.</p>
<p><strong>UNiD.validateAuthenticationResponse()</strong></p>
<p>{% tabs %}
{% tab title=”TypeScript” %}</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="p">{</span> <span class="nx">UNiD</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/node-wallet-sdk&#39;</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// Verify SIOP Response with walletDid</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">UNiD</span><span class="p">.</span><span class="nx">validateAuthenticationRequest</span><span class="p">(</span><span class="nx">walletDid</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Complete validating DID AuthN Request&#39;</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="nx">err</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">err</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">})()</span>
</pre></div>
</div>
<p>{% endtab %}
{% endtabs %}</p>
<p>If the required parameter or authorization code is not included in the response, an error will occur and the authentication process will be interrupted.</p>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, UNiD Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>