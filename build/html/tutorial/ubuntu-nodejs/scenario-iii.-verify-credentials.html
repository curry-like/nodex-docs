<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scenario III. Verify Credentials &mdash; UNiD Docs  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/twemoji.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js"></script>
        <script src="../../_static/twemoji.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> UNiD Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Scenario III. Verify Credentials</a><ul>
<li><a class="reference internal" href="#goals">Goals</a></li>
<li><a class="reference internal" href="#tutorial-flow">Tutorial flow</a></li>
<li><a class="reference internal" href="#verification-of-signed-structured-data">4. Verification of signed structured data</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">UNiD Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Scenario III. Verify Credentials</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorial/ubuntu-nodejs/scenario-iii.-verify-credentials.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="scenario-iii-verify-credentials">
<h1>Scenario III. Verify Credentials<a class="headerlink" href="#scenario-iii-verify-credentials" title="Permalink to this headline"></a></h1>
<p>In Scenario III, you will learn how to use the UNiD EDGE SDK to verify the signature of digitally signed JSON-LD based structured data and authenticate that the data has not been tampered with.</p>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>By following this tutorial, you will learn how to use the UNiD EDGE SDK to perform validation of signed structured data (JSON-LD).</p></li>
</ul>
</div>
<div class="section" id="tutorial-flow">
<h2>Tutorial flow<a class="headerlink" href="#tutorial-flow" title="Permalink to this headline"></a></h2>
<p>This tutorial will proceed in the order defined below. The steps from “1. Creating a NodeJS project” to “3. Using UNiD EDGE SDK” in the tutorial are exactly the same as <a class="reference internal" href="scenario-i.-create-a-did.html"><span class="doc std std-doc">Scenario I</span></a>. Please refer to Scenario I page for the details.</p>
<ol class="arabic simple">
<li><p>Creating a NodeJS project</p></li>
<li><p>Install dependencies and project settings</p></li>
<li><p>Using UNiD EDGE SDK</p></li>
<li><p>Verification of signed structured data</p></li>
</ol>
</div>
<div class="section" id="verification-of-signed-structured-data">
<h2>4. Verification of signed structured data<a class="headerlink" href="#verification-of-signed-structured-data" title="Permalink to this headline"></a></h2>
<p>Verifying the correctness of signed structured data (called Verifiable Credentials) is much easier than signing structured data with UNiD EDGE SDK! All you have to do is to pass the instance of the data you want to verify to the function provided by UNiD EDGE SDK as shown below.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ..</span>

    <span class="c1">// Insert your great code below this line</span>
    <span class="kd">const</span> <span class="nx">verifiedVC</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">UNiD</span><span class="p">.</span><span class="nx">verifyCredential</span><span class="p">(</span><span class="nx">VC</span><span class="p">)</span>
<span class="p">})()</span>
</pre></div>
</div>
<div class="admonition-info admonition">
<p class="admonition-title">Info</p>
<p>In UNiD EDGE SDK, you can use <code class="docutils literal notranslate"><span class="pre">DID.createCredential()</span></code> function in Scenario II to create <code class="docutils literal notranslate"><span class="pre">VC</span></code> instances. In UNiD EDGE SDK, you can use the generated instance as <code class="docutils literal notranslate"><span class="pre">VC</span></code> by using <code class="docutils literal notranslate"><span class="pre">DID.createCredential()</span></code> function in Scenario II.</p>
</div>
<p>The process of verifying digital signature with UNiD EDGE SDK can be achieved with less code compared to adding signature to structured data. Assuming that you have received Verifiable Credentials as JSON data in text format, the following is the process of verifying the digital signature that has been assigned to the data.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Verifiable Credentials (signed structured data) received from somewhere</span>
<span class="kd">const</span> <span class="nx">VC</span> <span class="o">=</span> <span class="s1">&#39;{&quot;proof&quot;:{&quot;type&quot;:&quot;EcdsaSecp256k1Signature2019&quot;,&quot;proofPurpose&quot;:&quot;authentication&quot;,&quot;created&quot;:&quot;2022-01-17T09:22:12Z&quot;,&quot;verificationMethod&quot;:&quot;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ#signingKey&quot;,&quot;jws&quot;:&quot;eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..guJAa5aNwV21NUW0rtaYpMK1HJHIxyPO_mEg4SHNBEJEo5ku1o7NJA74FmYU2-pzHQbYGcSk9Zj6FdUr6j5eeQ&quot;},&quot;id&quot;:&quot;https://sds.getunid.io/api/v1&quot;,&quot;issuer&quot;:&quot;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ&quot;,&quot;issuanceDate&quot;:&quot;2022-01-17T09:22:12Z&quot;,&quot;@context&quot;:[&quot;https://www.w3.org/2018/credentials/v1&quot;,&quot;https://docs.getunid.io/docs/2020/credentials/email&quot;],&quot;type&quot;:[&quot;VerifiableCredential&quot;,&quot;EmailCredentialV1&quot;],&quot;credentialSubject&quot;:{&quot;@type&quot;:&quot;EmailPerson&quot;,&quot;@id&quot;:&quot;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ&quot;,&quot;email&quot;:&quot;username@example.com&quot;}}&#39;</span>

<span class="c1">// Deserialize it and...</span>
<span class="kd">const</span> <span class="nx">parsedVC</span> <span class="o">=</span> <span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">VC</span><span class="p">)</span>

<span class="c1">// Verify !!</span>
<span class="kd">const</span> <span class="nx">verifiedVC</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">UNiD</span><span class="p">.</span><span class="nx">verifyCredential</span><span class="p">(</span><span class="nx">parsedVC</span><span class="p">)</span>
</pre></div>
</div>
<p>The following is a sequence of code that includes how to verify Verifiable Credentials as shown so far in this chapter, and the process of displaying the results.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="p">{</span> <span class="nx">UNiD</span><span class="p">,</span> <span class="nx">Cipher</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/node-wallet-sdk&#39;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">SqliteConnector</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/wallet-sdk-sqlite-connector&#39;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">KeyRingType</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/node-wallet-sdk&#39;</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Connector definition</span>
    <span class="kd">const</span> <span class="nx">connector</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">SqliteConnector</span><span class="p">({</span>
        <span class="nx">client</span>       <span class="o">:</span> <span class="s1">&#39;unid-edge-sdk.sqlite&#39;</span><span class="p">,</span>
        <span class="nx">encryptionKey</span><span class="o">:</span> <span class="s1">&#39;${ PUT YOUR RANDOMIZED HEX STRING OF 32 BYTES }&#39;</span><span class="p">,</span>
        <span class="nx">encrypter</span>    : <span class="kt">Cipher.encrypt</span><span class="p">,</span>
        <span class="nx">decrypter</span>    : <span class="kt">Cipher.decrypt</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="c1">// Initializing the connector (database creation and migration)</span>
    <span class="k">await</span> <span class="nx">connector</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>

    <span class="c1">// Initializing the UNiD EDGE SDK</span>
    <span class="nx">UNiD</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
        <span class="nx">clientId</span>    <span class="o">:</span> <span class="s1">&#39;&lt;UNUSED_FIELD&gt;&#39;</span><span class="p">,</span>
        <span class="nx">clientSecret</span><span class="o">:</span> <span class="s1">&#39;&lt;UNUSED_FIELD&gt;&#39;</span><span class="p">,</span>
        <span class="nx">connector</span>   : <span class="kt">connector</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="c1">// Insert your great code below this line</span>
    <span class="kd">const</span> <span class="nx">VC</span> <span class="o">=</span> <span class="s1">&#39;{&quot;proof&quot;:{&quot;type&quot;:&quot;EcdsaSecp256k1Signature2019&quot;,&quot;proofPurpose&quot;:&quot;authentication&quot;,&quot;created&quot;:&quot;2022-01-17T09:22:12Z&quot;,&quot;verificationMethod&quot;:&quot;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ#signingKey&quot;,&quot;jws&quot;:&quot;eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..guJAa5aNwV21NUW0rtaYpMK1HJHIxyPO_mEg4SHNBEJEo5ku1o7NJA74FmYU2-pzHQbYGcSk9Zj6FdUr6j5eeQ&quot;},&quot;id&quot;:&quot;https://sds.getunid.io/api/v1&quot;,&quot;issuer&quot;:&quot;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ&quot;,&quot;issuanceDate&quot;:&quot;2022-01-17T09:22:12Z&quot;,&quot;@context&quot;:[&quot;https://www.w3.org/2018/credentials/v1&quot;,&quot;https://docs.getunid.io/docs/2020/credentials/email&quot;],&quot;type&quot;:[&quot;VerifiableCredential&quot;,&quot;EmailCredentialV1&quot;],&quot;credentialSubject&quot;:{&quot;@type&quot;:&quot;EmailPerson&quot;,&quot;@id&quot;:&quot;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ&quot;,&quot;email&quot;:&quot;username@example.com&quot;}}&#39;</span>
    <span class="kd">const</span> <span class="nx">parsedVC</span> <span class="o">=</span> <span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">VC</span><span class="p">)</span>

    <span class="c1">// Verify !!</span>
    <span class="kd">const</span> <span class="nx">verifiedVC</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">UNiD</span><span class="p">.</span><span class="nx">verifyCredential</span><span class="p">(</span><span class="nx">parsedVC</span><span class="p">)</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`isValid: </span><span class="si">${</span> <span class="nx">verifiedVC</span><span class="p">.</span><span class="nx">isValid</span> <span class="si">}</span><span class="sb">`</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`payload:`</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">verifiedVC</span><span class="p">.</span><span class="nx">payload</span><span class="p">)</span>
<span class="p">})()</span>
</pre></div>
</div>
<p>Let’s run the program in the same way as before.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn run start
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn run v1.22.17
$ yarn run node index.ts
$ npx ts-node index.ts
isValid: <span class="nb">true</span>
payload:
<span class="o">{</span>
  id: <span class="s1">&#39;https://sds.getunid.io/api/v1&#39;</span>,
  issuer: <span class="s1">&#39;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ&#39;</span>,
  issuanceDate: <span class="s1">&#39;2022-01-17T09:22:12Z&#39;</span>,
  <span class="s1">&#39;@context&#39;</span>: <span class="o">[</span>
    <span class="s1">&#39;https://www.w3.org/2018/credentials/v1&#39;</span>,
    <span class="s1">&#39;https://docs.getunid.io/docs/2020/credentials/email&#39;</span>
  <span class="o">]</span>,
  type: <span class="o">[</span> <span class="s1">&#39;VerifiableCredential&#39;</span>, <span class="s1">&#39;EmailCredentialV1&#39;</span> <span class="o">]</span>,
  credentialSubject: <span class="o">{</span>
    <span class="s1">&#39;@type&#39;</span>: <span class="s1">&#39;EmailPerson&#39;</span>,
    <span class="s1">&#39;@id&#39;</span>: <span class="s1">&#39;did:unid:test:EiCayXi7bi3duWVSB3o3nL8E6zuXy6c_W95mTxbs3pDgIQ&#39;</span>,
    email: <span class="s1">&#39;username@example.com&#39;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Do you see the output like this? First, let’s make sure that the value of isValid is true. The value of payload represents the Verifiable Credentials excluding the signature part (the value of credentialSubject represents the original structured data, in this case the data structure used to represent the email address). By leveraging the signature data validation process in conjunction with web frameworks such as Express and Fastify, as we do when signing structured data, we can address a variety of use cases!</p>
<p><strong>Index of UNiD EDGE SDK / Ubuntu (NodeJS) tutorials:</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="scenario-i.-create-a-did.html"><span class="doc std std-doc">Scenario I. Create a DID</span></a></p></li>
<li><p><a class="reference internal" href="scenario-ii.-sign-credentials.html"><span class="doc std std-doc">Scenario II. Sign Credentials</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="doc std std-doc">Scenario III. Verify Credentials</span></a></p></li>
<li><p><a class="reference internal" href="scenario-iv.-connect-with-secure-channel.html"><span class="doc std std-doc">Scenario IV. Connect with E2E Secure Channel</span></a></p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, UNiD Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>