<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scenario II. Sign Credentials &mdash; UNiD Docs  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/twemoji.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js"></script>
        <script src="../../_static/twemoji.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> UNiD Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Scenario II. Sign Credentials</a><ul>
<li><a class="reference internal" href="#goals">Goals</a></li>
<li><a class="reference internal" href="#tutorial-flow">Tutorial flow</a></li>
<li><a class="reference internal" href="#digitally-sign-structured-data">4. Digitally sign structured data</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">UNiD Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Scenario II. Sign Credentials</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorial/ubuntu-nodejs/scenario-ii.-sign-credentials.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="scenario-ii-sign-credentials">
<h1>Scenario II. Sign Credentials<a class="headerlink" href="#scenario-ii-sign-credentials" title="Permalink to this headline"></a></h1>
<p>In Scenario II, you will learn how to apply digital signature to JSON-LD based structured data using UNiD EDGE SDK.</p>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>By following this tutorial, you will learn how to digitally sign JSON-LD based structured data using UNiD EDGE SDK.</p></li>
</ul>
</div>
<div class="section" id="tutorial-flow">
<h2>Tutorial flow<a class="headerlink" href="#tutorial-flow" title="Permalink to this headline"></a></h2>
<p>This tutorial will proceed in the order defined below. The steps from “1. Creating a NodeJS project” to “3. Using UNiD EDGE SDK” in the tutorial are exactly the same as <a class="reference internal" href="scenario-i.-create-a-did.html"><span class="doc std std-doc">Scenario I</span></a>. Please refer to Scenario I page for the details.</p>
<ol class="arabic simple">
<li><p>Creating a NodeJS project</p></li>
<li><p>Install dependencies and project settings</p></li>
<li><p>Using UNiD EDGE SDK</p></li>
<li><p>Digitally sign structured data</p></li>
</ol>
</div>
<div class="section" id="digitally-sign-structured-data">
<h2>4. Digitally sign structured data<a class="headerlink" href="#digitally-sign-structured-data" title="Permalink to this headline"></a></h2>
<p>Digitally signing structured data is also easy with the UNiD EDGE SDK! You only need to include the following few statements in your code to benefit from digital signatures.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ..</span>

    <span class="c1">// Insert your great code below this line</span>
    <span class="kd">const</span> <span class="nx">VC</span> <span class="o">=</span> <span class="nx">DID</span><span class="p">.</span><span class="nx">createCredential</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">AWESOME_INSTANCE</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">})()</span>
</pre></div>
</div>
<div class="admonition-info admonition">
<p class="admonition-title">Info</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DID</span></code> instance in the code fragment can be generated using the <code class="docutils literal notranslate"><span class="pre">createDid()</span></code> function, etc., which is handled in <a class="reference internal" href="scenario-i.-create-a-did.html"><span class="doc std std-doc">Scenario I</span></a>.</p>
</div>
<p>The object that can be passed to the <code class="docutils literal notranslate"><span class="pre">createCredential()</span></code> function must be an object that inherits from the <code class="docutils literal notranslate"><span class="pre">UNiDVerifiableCredentialBase</span></code> class. UNiD EDGE SDK predefines several data types to represent structured data and binds them to the SDK. In this chapter, we will try to express the code using the <code class="docutils literal notranslate"><span class="pre">EmailCredentialV1</span></code> class, which can be used to represent email data from among its data types.</p>
<div class="admonition-info admonition">
<p class="admonition-title">Info</p>
<p><code class="docutils literal notranslate"><span class="pre">EmailCredentialV1</span></code> class is included in UNiD EDGE SDK, but it will not be imported automatically. Don’t forget to import it!</p>
</div>
<p>A snippet of code combining the <code class="docutils literal notranslate"><span class="pre">EmailCredentialV1</span></code> class, which represents the data structure, and the <code class="docutils literal notranslate"><span class="pre">createCredential()</span></code> function, which is used to apply a digital signature, is shown below.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">structuredData</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">EmailCredentialV1</span><span class="p">({</span>
    <span class="s1">&#39;@type&#39;</span><span class="o">:</span> <span class="s1">&#39;EmailPerson&#39;</span><span class="p">,</span>
    <span class="s1">&#39;@id&#39;</span><span class="o">:</span> <span class="nx">DID</span><span class="p">.</span><span class="nx">getIdentifier</span><span class="p">(),</span>
    <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;username@example.com&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1">// Sign !!</span>
<span class="kd">const</span> <span class="nx">VC</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DID</span><span class="p">.</span><span class="nx">createCredential</span><span class="p">(</span><span class="nx">structuredData</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-info admonition">
<p class="admonition-title">Info</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DID</span></code> instance in the code fragment can be generated using the <code class="docutils literal notranslate"><span class="pre">createDid()</span></code> function, etc., which is handled in <a class="reference internal" href="scenario-i.-create-a-did.html"><span class="doc std std-doc">Scenario I</span></a>.</p>
</div>
<p>The following is a series of code fragments, including the method of digitally signing structured data and the process of displaying the results.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="p">{</span> <span class="nx">UNiD</span><span class="p">,</span> <span class="nx">Cipher</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/node-wallet-sdk&#39;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">SqliteConnector</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/wallet-sdk-sqlite-connector&#39;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">KeyRingType</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@getunid/node-wallet-sdk&#39;</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Connector definition</span>
    <span class="kd">const</span> <span class="nx">connector</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">SqliteConnector</span><span class="p">({</span>
        <span class="nx">client</span>       <span class="o">:</span> <span class="s1">&#39;unid-edge-sdk.sqlite&#39;</span><span class="p">,</span>
        <span class="nx">encryptionKey</span><span class="o">:</span> <span class="s1">&#39;${ PUT YOUR RANDOMIZED HEX STRING OF 32 BYTES }&#39;</span><span class="p">,</span>
        <span class="nx">encrypter</span>    : <span class="kt">Cipher.encrypt</span><span class="p">,</span>
        <span class="nx">decrypter</span>    : <span class="kt">Cipher.decrypt</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="c1">// Initializing the connector (database creation and migration)</span>
    <span class="k">await</span> <span class="nx">connector</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>

    <span class="c1">// Initializing the UNiD EDGE SDK</span>
    <span class="nx">UNiD</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
        <span class="nx">clientId</span>    <span class="o">:</span> <span class="s1">&#39;&lt;UNUSED_FIELD&gt;&#39;</span><span class="p">,</span>
        <span class="nx">clientSecret</span><span class="o">:</span> <span class="s1">&#39;&lt;UNUSED_FIELD&gt;&#39;</span><span class="p">,</span>
        <span class="nx">connector</span>   : <span class="kt">connector</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="c1">// Insert your great code below this line</span>
    <span class="kd">const</span> <span class="nx">DID</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">UNiD</span><span class="p">.</span><span class="nx">createDid</span><span class="p">(</span><span class="nx">KeyRingType</span><span class="p">.</span><span class="nx">Mnemonic</span><span class="p">)</span>

    <span class="c1">// Build</span>
    <span class="kd">const</span> <span class="nx">structuredData</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">EmailCredentialV1</span><span class="p">({</span>
        <span class="s1">&#39;@type&#39;</span><span class="o">:</span> <span class="s1">&#39;EmailPerson&#39;</span><span class="p">,</span>
        <span class="s1">&#39;@id&#39;</span>  <span class="o">:</span> <span class="nx">DID</span><span class="p">.</span><span class="nx">getIdentifier</span><span class="p">(),</span>
        <span class="nx">email</span>  <span class="o">:</span> <span class="s1">&#39;username@example.com&#39;</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="c1">// Sign !!</span>
    <span class="kd">const</span> <span class="nx">VC</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">DID</span><span class="p">.</span><span class="nx">createCredential</span><span class="p">(</span><span class="nx">structuredData</span><span class="p">)</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`signed credential:`</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">VC</span><span class="p">)</span>
<span class="p">})()</span>
</pre></div>
</div>
<p>Let’s run the program in the same way as before.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn run start
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn run v1.22.17
$ yarn run node index.ts
$ npx ts-node index.ts
signed credential:
<span class="o">{</span>
  proof: <span class="o">{</span>
    type: <span class="s1">&#39;EcdsaSecp256k1Signature2019&#39;</span>,
    proofPurpose: <span class="s1">&#39;authentication&#39;</span>,
    created: <span class="s1">&#39;2022-01-14T09:36:45Z&#39;</span>,
    verificationMethod: <span class="s1">&#39;did:unid:test:EiDrgMyWJYZyzeGFIKzJzI2NtU7yng_21EbMT_1enUZ5Xg#signingKey&#39;</span>,
    jws: <span class="s1">&#39;eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..NypXoAh1q2vGibRmxzBCX7gwbCCIlLh_GA8W73L613NxDn6IDvqO0BgIPzMmpoHJtuAA8jxAa4y1KM4g5e8f4w&#39;</span>
  <span class="o">}</span>,
  id: <span class="s1">&#39;https://sds.getunid.io/api/v1&#39;</span>,
  issuer: <span class="s1">&#39;did:unid:test:EiDrgMyWJYZyzeGFIKzJzI2NtU7yng_21EbMT_1enUZ5Xg&#39;</span>,
  issuanceDate: <span class="s1">&#39;2022-01-14T09:36:45Z&#39;</span>,
  <span class="s1">&#39;@context&#39;</span>: <span class="o">[</span>
    <span class="s1">&#39;https://www.w3.org/2018/credentials/v1&#39;</span>,
    <span class="s1">&#39;https://docs.getunid.io/docs/2020/credentials/email&#39;</span>
  <span class="o">]</span>,
  type: <span class="o">[</span> <span class="s1">&#39;VerifiableCredential&#39;</span>, <span class="s1">&#39;EmailCredentialV1&#39;</span> <span class="o">]</span>,
  credentialSubject: <span class="o">{</span>
    <span class="s1">&#39;@type&#39;</span>: <span class="s1">&#39;EmailPerson&#39;</span>,
    <span class="s1">&#39;@id&#39;</span>: <span class="s1">&#39;did:unid:test:EiDrgMyWJYZyzeGFIKzJzI2NtU7yng_21EbMT_1enUZ5Xg&#39;</span>,
    email: <span class="s1">&#39;username@example.com&#39;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Did you see the data (JSON block) shown above in your terminal? Data that has been signed for structured data is called Verifiable Credential in the DID specification, and in the standard output above, the JSON block output below the label signed credential corresponds to Verifiable Credential. This chapter may be boring because we did the digital signature as a console application. However, when combined with a web framework such as Express or Fastify, it may be possible to easily issue digitally signed copies of verified data stored on the server application side (e.g., resident data if you are in charge of a government agency). How would you like to use the signed structured data?</p>
<p>In the next chapter, you will learn how to use UNiD EDGE SDK to verify the correctness of signed structured data.</p>
<p><strong>Index of UNiD EDGE SDK / Ubuntu (NodeJS) tutorials:</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="scenario-i.-create-a-did.html"><span class="doc std std-doc">Scenario I. Create a DID</span></a></p></li>
<li><p><a class="reference internal" href="#"><span class="doc std std-doc">Scenario II. Sign Credentials</span></a></p></li>
<li><p><a class="reference internal" href="scenario-iii.-verify-credentials.html"><span class="doc std std-doc">Scenario III. Verify Credentials</span></a></p></li>
<li><p><a class="reference internal" href="scenario-iv.-connect-with-secure-channel.html"><span class="doc std std-doc">Scenario IV. Connect with E2E Secure Channel</span></a></p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, UNiD Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>